

```python
%pylab inline
from __future__ import division
import pandas as pd
```

    Populating the interactive namespace from numpy and matplotlib
    


```python
df = pd.read_csv('sz300001.csv', encoding='gbk')
df.columns = [i.encode('utf8') for i in df.columns]
df = df[['交易日期', '股票代码', '开盘价', '最高价', '最低价', '收盘价', '涨跌幅']]
df.sort_values(by=['交易日期'], inplace=True)
df['交易日期'] = pd.to_datetime(df['交易日期'])
df.reset_index(inplace=True, drop=True)
df
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>交易日期</th>
      <th>股票代码</th>
      <th>开盘价</th>
      <th>最高价</th>
      <th>最低价</th>
      <th>收盘价</th>
      <th>涨跌幅</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2009-10-30</td>
      <td>sz300001</td>
      <td>42.00</td>
      <td>64.00</td>
      <td>35.01</td>
      <td>44.00</td>
      <td>0.848739</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2009-11-02</td>
      <td>sz300001</td>
      <td>39.60</td>
      <td>41.87</td>
      <td>39.60</td>
      <td>39.60</td>
      <td>-0.100000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2009-11-03</td>
      <td>sz300001</td>
      <td>38.20</td>
      <td>39.36</td>
      <td>36.15</td>
      <td>36.90</td>
      <td>-0.068182</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2009-11-04</td>
      <td>sz300001</td>
      <td>38.00</td>
      <td>38.90</td>
      <td>37.23</td>
      <td>38.02</td>
      <td>0.030352</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2009-11-05</td>
      <td>sz300001</td>
      <td>38.03</td>
      <td>40.98</td>
      <td>37.51</td>
      <td>39.60</td>
      <td>0.041557</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2009-11-06</td>
      <td>sz300001</td>
      <td>39.63</td>
      <td>40.40</td>
      <td>38.25</td>
      <td>38.91</td>
      <td>-0.017424</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2009-11-09</td>
      <td>sz300001</td>
      <td>38.65</td>
      <td>39.90</td>
      <td>38.18</td>
      <td>39.48</td>
      <td>0.014649</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2009-11-10</td>
      <td>sz300001</td>
      <td>39.56</td>
      <td>39.80</td>
      <td>37.80</td>
      <td>37.97</td>
      <td>-0.038247</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2009-11-11</td>
      <td>sz300001</td>
      <td>37.65</td>
      <td>38.40</td>
      <td>37.00</td>
      <td>38.22</td>
      <td>0.006584</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2009-11-12</td>
      <td>sz300001</td>
      <td>38.20</td>
      <td>38.89</td>
      <td>37.50</td>
      <td>38.56</td>
      <td>0.008896</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2009-11-13</td>
      <td>sz300001</td>
      <td>38.57</td>
      <td>41.87</td>
      <td>38.57</td>
      <td>40.76</td>
      <td>0.057054</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2009-11-16</td>
      <td>sz300001</td>
      <td>40.80</td>
      <td>41.30</td>
      <td>39.62</td>
      <td>41.00</td>
      <td>0.005888</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2009-11-17</td>
      <td>sz300001</td>
      <td>40.90</td>
      <td>41.82</td>
      <td>40.55</td>
      <td>40.90</td>
      <td>-0.002439</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2009-11-18</td>
      <td>sz300001</td>
      <td>41.00</td>
      <td>43.16</td>
      <td>41.00</td>
      <td>42.84</td>
      <td>0.047433</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2009-11-19</td>
      <td>sz300001</td>
      <td>42.90</td>
      <td>47.10</td>
      <td>42.72</td>
      <td>44.91</td>
      <td>0.048319</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2009-11-20</td>
      <td>sz300001</td>
      <td>44.33</td>
      <td>46.55</td>
      <td>44.10</td>
      <td>44.38</td>
      <td>-0.011801</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2009-11-23</td>
      <td>sz300001</td>
      <td>44.33</td>
      <td>45.98</td>
      <td>44.12</td>
      <td>45.41</td>
      <td>0.023209</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2009-11-24</td>
      <td>sz300001</td>
      <td>45.80</td>
      <td>46.23</td>
      <td>41.01</td>
      <td>41.43</td>
      <td>-0.087646</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2009-11-25</td>
      <td>sz300001</td>
      <td>41.13</td>
      <td>44.19</td>
      <td>41.10</td>
      <td>43.90</td>
      <td>0.059619</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2009-11-26</td>
      <td>sz300001</td>
      <td>43.70</td>
      <td>47.49</td>
      <td>43.00</td>
      <td>47.28</td>
      <td>0.076993</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2009-11-27</td>
      <td>sz300001</td>
      <td>46.10</td>
      <td>48.60</td>
      <td>45.54</td>
      <td>47.30</td>
      <td>0.000423</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2009-11-30</td>
      <td>sz300001</td>
      <td>47.32</td>
      <td>47.90</td>
      <td>45.00</td>
      <td>46.92</td>
      <td>-0.008034</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2009-12-01</td>
      <td>sz300001</td>
      <td>46.48</td>
      <td>47.38</td>
      <td>45.70</td>
      <td>46.98</td>
      <td>0.001279</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2009-12-02</td>
      <td>sz300001</td>
      <td>47.10</td>
      <td>49.85</td>
      <td>46.68</td>
      <td>48.17</td>
      <td>0.025330</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2009-12-03</td>
      <td>sz300001</td>
      <td>48.01</td>
      <td>50.24</td>
      <td>47.19</td>
      <td>50.16</td>
      <td>0.041312</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2009-12-04</td>
      <td>sz300001</td>
      <td>48.00</td>
      <td>49.15</td>
      <td>45.14</td>
      <td>45.56</td>
      <td>-0.091707</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2009-12-07</td>
      <td>sz300001</td>
      <td>45.30</td>
      <td>46.52</td>
      <td>44.60</td>
      <td>46.32</td>
      <td>0.016681</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2009-12-08</td>
      <td>sz300001</td>
      <td>46.30</td>
      <td>48.43</td>
      <td>46.30</td>
      <td>47.86</td>
      <td>0.033247</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2009-12-09</td>
      <td>sz300001</td>
      <td>47.40</td>
      <td>49.80</td>
      <td>47.04</td>
      <td>48.01</td>
      <td>0.003134</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2009-12-10</td>
      <td>sz300001</td>
      <td>48.00</td>
      <td>48.99</td>
      <td>47.00</td>
      <td>47.40</td>
      <td>-0.012706</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1610</th>
      <td>2016-11-03</td>
      <td>sz300001</td>
      <td>20.21</td>
      <td>20.39</td>
      <td>20.09</td>
      <td>20.16</td>
      <td>-0.006407</td>
    </tr>
    <tr>
      <th>1611</th>
      <td>2016-11-04</td>
      <td>sz300001</td>
      <td>20.13</td>
      <td>20.30</td>
      <td>19.94</td>
      <td>20.14</td>
      <td>-0.000992</td>
    </tr>
    <tr>
      <th>1612</th>
      <td>2016-11-07</td>
      <td>sz300001</td>
      <td>20.11</td>
      <td>20.24</td>
      <td>19.96</td>
      <td>20.16</td>
      <td>0.000993</td>
    </tr>
    <tr>
      <th>1613</th>
      <td>2016-11-08</td>
      <td>sz300001</td>
      <td>20.16</td>
      <td>20.24</td>
      <td>20.01</td>
      <td>20.14</td>
      <td>-0.000992</td>
    </tr>
    <tr>
      <th>1614</th>
      <td>2016-11-09</td>
      <td>sz300001</td>
      <td>20.07</td>
      <td>20.19</td>
      <td>19.72</td>
      <td>19.97</td>
      <td>-0.008441</td>
    </tr>
    <tr>
      <th>1615</th>
      <td>2016-11-10</td>
      <td>sz300001</td>
      <td>20.09</td>
      <td>20.35</td>
      <td>20.08</td>
      <td>20.31</td>
      <td>0.017026</td>
    </tr>
    <tr>
      <th>1616</th>
      <td>2016-11-11</td>
      <td>sz300001</td>
      <td>20.31</td>
      <td>20.35</td>
      <td>20.13</td>
      <td>20.34</td>
      <td>0.001477</td>
    </tr>
    <tr>
      <th>1617</th>
      <td>2016-11-14</td>
      <td>sz300001</td>
      <td>20.34</td>
      <td>20.55</td>
      <td>20.26</td>
      <td>20.35</td>
      <td>0.000492</td>
    </tr>
    <tr>
      <th>1618</th>
      <td>2016-11-15</td>
      <td>sz300001</td>
      <td>20.27</td>
      <td>20.34</td>
      <td>20.04</td>
      <td>20.30</td>
      <td>-0.002457</td>
    </tr>
    <tr>
      <th>1619</th>
      <td>2016-11-16</td>
      <td>sz300001</td>
      <td>20.40</td>
      <td>20.54</td>
      <td>20.19</td>
      <td>20.19</td>
      <td>-0.005419</td>
    </tr>
    <tr>
      <th>1620</th>
      <td>2016-11-17</td>
      <td>sz300001</td>
      <td>20.09</td>
      <td>20.36</td>
      <td>20.05</td>
      <td>20.13</td>
      <td>-0.002972</td>
    </tr>
    <tr>
      <th>1621</th>
      <td>2016-11-18</td>
      <td>sz300001</td>
      <td>20.30</td>
      <td>20.30</td>
      <td>20.07</td>
      <td>20.09</td>
      <td>-0.001987</td>
    </tr>
    <tr>
      <th>1622</th>
      <td>2016-11-21</td>
      <td>sz300001</td>
      <td>20.10</td>
      <td>20.18</td>
      <td>20.01</td>
      <td>20.10</td>
      <td>0.000498</td>
    </tr>
    <tr>
      <th>1623</th>
      <td>2016-11-22</td>
      <td>sz300001</td>
      <td>20.11</td>
      <td>20.27</td>
      <td>20.03</td>
      <td>20.26</td>
      <td>0.007960</td>
    </tr>
    <tr>
      <th>1624</th>
      <td>2016-11-23</td>
      <td>sz300001</td>
      <td>20.28</td>
      <td>20.54</td>
      <td>20.28</td>
      <td>20.32</td>
      <td>0.002962</td>
    </tr>
    <tr>
      <th>1625</th>
      <td>2016-11-24</td>
      <td>sz300001</td>
      <td>20.31</td>
      <td>20.31</td>
      <td>20.07</td>
      <td>20.11</td>
      <td>-0.010335</td>
    </tr>
    <tr>
      <th>1626</th>
      <td>2016-11-25</td>
      <td>sz300001</td>
      <td>20.08</td>
      <td>20.39</td>
      <td>20.02</td>
      <td>20.37</td>
      <td>0.012929</td>
    </tr>
    <tr>
      <th>1627</th>
      <td>2016-11-28</td>
      <td>sz300001</td>
      <td>20.45</td>
      <td>20.50</td>
      <td>20.21</td>
      <td>20.24</td>
      <td>-0.006382</td>
    </tr>
    <tr>
      <th>1628</th>
      <td>2016-11-29</td>
      <td>sz300001</td>
      <td>20.24</td>
      <td>20.45</td>
      <td>20.15</td>
      <td>20.21</td>
      <td>-0.001482</td>
    </tr>
    <tr>
      <th>1629</th>
      <td>2016-11-30</td>
      <td>sz300001</td>
      <td>20.16</td>
      <td>20.47</td>
      <td>20.11</td>
      <td>20.34</td>
      <td>0.006432</td>
    </tr>
    <tr>
      <th>1630</th>
      <td>2016-12-01</td>
      <td>sz300001</td>
      <td>20.38</td>
      <td>20.76</td>
      <td>20.31</td>
      <td>20.66</td>
      <td>0.015733</td>
    </tr>
    <tr>
      <th>1631</th>
      <td>2016-12-02</td>
      <td>sz300001</td>
      <td>20.55</td>
      <td>20.62</td>
      <td>20.21</td>
      <td>20.22</td>
      <td>-0.021297</td>
    </tr>
    <tr>
      <th>1632</th>
      <td>2016-12-05</td>
      <td>sz300001</td>
      <td>20.05</td>
      <td>20.48</td>
      <td>20.01</td>
      <td>20.21</td>
      <td>-0.000495</td>
    </tr>
    <tr>
      <th>1633</th>
      <td>2016-12-06</td>
      <td>sz300001</td>
      <td>20.25</td>
      <td>20.39</td>
      <td>20.02</td>
      <td>20.02</td>
      <td>-0.009401</td>
    </tr>
    <tr>
      <th>1634</th>
      <td>2016-12-07</td>
      <td>sz300001</td>
      <td>20.02</td>
      <td>20.12</td>
      <td>19.81</td>
      <td>20.06</td>
      <td>0.001998</td>
    </tr>
    <tr>
      <th>1635</th>
      <td>2016-12-08</td>
      <td>sz300001</td>
      <td>20.06</td>
      <td>20.10</td>
      <td>19.70</td>
      <td>19.71</td>
      <td>-0.017448</td>
    </tr>
    <tr>
      <th>1636</th>
      <td>2016-12-09</td>
      <td>sz300001</td>
      <td>19.77</td>
      <td>19.85</td>
      <td>19.35</td>
      <td>19.49</td>
      <td>-0.011162</td>
    </tr>
    <tr>
      <th>1637</th>
      <td>2016-12-12</td>
      <td>sz300001</td>
      <td>19.57</td>
      <td>19.66</td>
      <td>17.74</td>
      <td>17.90</td>
      <td>-0.081580</td>
    </tr>
    <tr>
      <th>1638</th>
      <td>2016-12-13</td>
      <td>sz300001</td>
      <td>17.99</td>
      <td>18.18</td>
      <td>17.78</td>
      <td>17.91</td>
      <td>0.000559</td>
    </tr>
    <tr>
      <th>1639</th>
      <td>2016-12-14</td>
      <td>sz300001</td>
      <td>17.92</td>
      <td>18.15</td>
      <td>17.78</td>
      <td>17.95</td>
      <td>0.002233</td>
    </tr>
  </tbody>
</table>
<p>1640 rows × 7 columns</p>
</div>




```python
def macd(df, m=12, n=26):
    df['EMA_s'] = df['收盘价'].ewm(span=m, adjust=False).mean()
    df['EMA_l'] = df['收盘价'].ewm(span=n, adjust=False).mean()
    
    df['DIF'] = df['EMA_s'] - df['EMA_l']
    df['DEA'] = df['DIF'].ewm(span=9, adjust=False).mean()
    
    df.drop(['EMA_s', 'EMA_l'], axis=1, inplace=True)
    
    return df
```


```python
macd(df, m=12, n=26)
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>交易日期</th>
      <th>股票代码</th>
      <th>开盘价</th>
      <th>最高价</th>
      <th>最低价</th>
      <th>收盘价</th>
      <th>涨跌幅</th>
      <th>DIF</th>
      <th>DEA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2009-10-30</td>
      <td>sz300001</td>
      <td>42.00</td>
      <td>64.00</td>
      <td>35.01</td>
      <td>44.00</td>
      <td>0.848739</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2009-11-02</td>
      <td>sz300001</td>
      <td>39.60</td>
      <td>41.87</td>
      <td>39.60</td>
      <td>39.60</td>
      <td>-0.100000</td>
      <td>-0.350997</td>
      <td>-0.070199</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2009-11-03</td>
      <td>sz300001</td>
      <td>38.20</td>
      <td>39.36</td>
      <td>36.15</td>
      <td>36.90</td>
      <td>-0.068182</td>
      <td>-0.837380</td>
      <td>-0.223635</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2009-11-04</td>
      <td>sz300001</td>
      <td>38.00</td>
      <td>38.90</td>
      <td>37.23</td>
      <td>38.02</td>
      <td>0.030352</td>
      <td>-1.119561</td>
      <td>-0.402821</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2009-11-05</td>
      <td>sz300001</td>
      <td>38.03</td>
      <td>40.98</td>
      <td>37.51</td>
      <td>39.60</td>
      <td>0.041557</td>
      <td>-1.201845</td>
      <td>-0.562625</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2009-11-06</td>
      <td>sz300001</td>
      <td>39.63</td>
      <td>40.40</td>
      <td>38.25</td>
      <td>38.91</td>
      <td>-0.017424</td>
      <td>-1.307659</td>
      <td>-0.711632</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2009-11-09</td>
      <td>sz300001</td>
      <td>38.65</td>
      <td>39.90</td>
      <td>38.18</td>
      <td>39.48</td>
      <td>0.014649</td>
      <td>-1.330189</td>
      <td>-0.835343</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2009-11-10</td>
      <td>sz300001</td>
      <td>39.56</td>
      <td>39.80</td>
      <td>37.80</td>
      <td>37.97</td>
      <td>-0.038247</td>
      <td>-1.453138</td>
      <td>-0.958902</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2009-11-11</td>
      <td>sz300001</td>
      <td>37.65</td>
      <td>38.40</td>
      <td>37.00</td>
      <td>38.22</td>
      <td>0.006584</td>
      <td>-1.512963</td>
      <td>-1.069714</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2009-11-12</td>
      <td>sz300001</td>
      <td>38.20</td>
      <td>38.89</td>
      <td>37.50</td>
      <td>38.56</td>
      <td>0.008896</td>
      <td>-1.515470</td>
      <td>-1.158865</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2009-11-13</td>
      <td>sz300001</td>
      <td>38.57</td>
      <td>41.87</td>
      <td>38.57</td>
      <td>40.76</td>
      <td>0.057054</td>
      <td>-1.324665</td>
      <td>-1.192025</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2009-11-16</td>
      <td>sz300001</td>
      <td>40.80</td>
      <td>41.30</td>
      <td>39.62</td>
      <td>41.00</td>
      <td>0.005888</td>
      <td>-1.140933</td>
      <td>-1.181807</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2009-11-17</td>
      <td>sz300001</td>
      <td>40.90</td>
      <td>41.82</td>
      <td>40.55</td>
      <td>40.90</td>
      <td>-0.002439</td>
      <td>-0.991958</td>
      <td>-1.143837</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2009-11-18</td>
      <td>sz300001</td>
      <td>41.00</td>
      <td>43.16</td>
      <td>41.00</td>
      <td>42.84</td>
      <td>0.047433</td>
      <td>-0.709178</td>
      <td>-1.056905</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2009-11-19</td>
      <td>sz300001</td>
      <td>42.90</td>
      <td>47.10</td>
      <td>42.72</td>
      <td>44.91</td>
      <td>0.048319</td>
      <td>-0.314416</td>
      <td>-0.908407</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2009-11-20</td>
      <td>sz300001</td>
      <td>44.33</td>
      <td>46.55</td>
      <td>44.10</td>
      <td>44.38</td>
      <td>-0.011801</td>
      <td>-0.043827</td>
      <td>-0.735491</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2009-11-23</td>
      <td>sz300001</td>
      <td>44.33</td>
      <td>45.98</td>
      <td>44.12</td>
      <td>45.41</td>
      <td>0.023209</td>
      <td>0.250839</td>
      <td>-0.538225</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2009-11-24</td>
      <td>sz300001</td>
      <td>45.80</td>
      <td>46.23</td>
      <td>41.01</td>
      <td>41.43</td>
      <td>-0.087646</td>
      <td>0.161350</td>
      <td>-0.398310</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2009-11-25</td>
      <td>sz300001</td>
      <td>41.13</td>
      <td>44.19</td>
      <td>41.10</td>
      <td>43.90</td>
      <td>0.059619</td>
      <td>0.286437</td>
      <td>-0.261361</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2009-11-26</td>
      <td>sz300001</td>
      <td>43.70</td>
      <td>47.49</td>
      <td>43.00</td>
      <td>47.28</td>
      <td>0.076993</td>
      <td>0.650804</td>
      <td>-0.078928</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2009-11-27</td>
      <td>sz300001</td>
      <td>46.10</td>
      <td>48.60</td>
      <td>45.54</td>
      <td>47.30</td>
      <td>0.000423</td>
      <td>0.930456</td>
      <td>0.122949</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2009-11-30</td>
      <td>sz300001</td>
      <td>47.32</td>
      <td>47.90</td>
      <td>45.00</td>
      <td>46.92</td>
      <td>-0.008034</td>
      <td>1.108640</td>
      <td>0.320087</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2009-12-01</td>
      <td>sz300001</td>
      <td>46.48</td>
      <td>47.38</td>
      <td>45.70</td>
      <td>46.98</td>
      <td>0.001279</td>
      <td>1.240395</td>
      <td>0.504149</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2009-12-02</td>
      <td>sz300001</td>
      <td>47.10</td>
      <td>49.85</td>
      <td>46.68</td>
      <td>48.17</td>
      <td>0.025330</td>
      <td>1.424415</td>
      <td>0.688202</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2009-12-03</td>
      <td>sz300001</td>
      <td>48.01</td>
      <td>50.24</td>
      <td>47.19</td>
      <td>50.16</td>
      <td>0.041312</td>
      <td>1.711104</td>
      <td>0.892782</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2009-12-04</td>
      <td>sz300001</td>
      <td>48.00</td>
      <td>49.15</td>
      <td>45.14</td>
      <td>45.56</td>
      <td>-0.091707</td>
      <td>1.549266</td>
      <td>1.024079</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2009-12-07</td>
      <td>sz300001</td>
      <td>45.30</td>
      <td>46.52</td>
      <td>44.60</td>
      <td>46.32</td>
      <td>0.016681</td>
      <td>1.465442</td>
      <td>1.112352</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2009-12-08</td>
      <td>sz300001</td>
      <td>46.30</td>
      <td>48.43</td>
      <td>46.30</td>
      <td>47.86</td>
      <td>0.033247</td>
      <td>1.505916</td>
      <td>1.191065</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2009-12-09</td>
      <td>sz300001</td>
      <td>47.40</td>
      <td>49.80</td>
      <td>47.04</td>
      <td>48.01</td>
      <td>0.003134</td>
      <td>1.532432</td>
      <td>1.259338</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2009-12-10</td>
      <td>sz300001</td>
      <td>48.00</td>
      <td>48.99</td>
      <td>47.00</td>
      <td>47.40</td>
      <td>-0.012706</td>
      <td>1.487081</td>
      <td>1.304887</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1610</th>
      <td>2016-11-03</td>
      <td>sz300001</td>
      <td>20.21</td>
      <td>20.39</td>
      <td>20.09</td>
      <td>20.16</td>
      <td>-0.006407</td>
      <td>-0.070107</td>
      <td>-0.125584</td>
    </tr>
    <tr>
      <th>1611</th>
      <td>2016-11-04</td>
      <td>sz300001</td>
      <td>20.13</td>
      <td>20.30</td>
      <td>19.94</td>
      <td>20.14</td>
      <td>-0.000992</td>
      <td>-0.061237</td>
      <td>-0.112714</td>
    </tr>
    <tr>
      <th>1612</th>
      <td>2016-11-07</td>
      <td>sz300001</td>
      <td>20.11</td>
      <td>20.24</td>
      <td>19.96</td>
      <td>20.16</td>
      <td>0.000993</td>
      <td>-0.051994</td>
      <td>-0.100570</td>
    </tr>
    <tr>
      <th>1613</th>
      <td>2016-11-08</td>
      <td>sz300001</td>
      <td>20.16</td>
      <td>20.24</td>
      <td>20.01</td>
      <td>20.14</td>
      <td>-0.000992</td>
      <td>-0.045755</td>
      <td>-0.089607</td>
    </tr>
    <tr>
      <th>1614</th>
      <td>2016-11-09</td>
      <td>sz300001</td>
      <td>20.07</td>
      <td>20.19</td>
      <td>19.72</td>
      <td>19.97</td>
      <td>-0.008441</td>
      <td>-0.053907</td>
      <td>-0.082467</td>
    </tr>
    <tr>
      <th>1615</th>
      <td>2016-11-10</td>
      <td>sz300001</td>
      <td>20.09</td>
      <td>20.35</td>
      <td>20.08</td>
      <td>20.31</td>
      <td>0.017026</td>
      <td>-0.032558</td>
      <td>-0.072485</td>
    </tr>
    <tr>
      <th>1616</th>
      <td>2016-11-11</td>
      <td>sz300001</td>
      <td>20.31</td>
      <td>20.35</td>
      <td>20.13</td>
      <td>20.34</td>
      <td>0.001477</td>
      <td>-0.013066</td>
      <td>-0.060602</td>
    </tr>
    <tr>
      <th>1617</th>
      <td>2016-11-14</td>
      <td>sz300001</td>
      <td>20.34</td>
      <td>20.55</td>
      <td>20.26</td>
      <td>20.35</td>
      <td>0.000492</td>
      <td>0.003151</td>
      <td>-0.047851</td>
    </tr>
    <tr>
      <th>1618</th>
      <td>2016-11-15</td>
      <td>sz300001</td>
      <td>20.27</td>
      <td>20.34</td>
      <td>20.04</td>
      <td>20.30</td>
      <td>-0.002457</td>
      <td>0.011833</td>
      <td>-0.035914</td>
    </tr>
    <tr>
      <th>1619</th>
      <td>2016-11-16</td>
      <td>sz300001</td>
      <td>20.40</td>
      <td>20.54</td>
      <td>20.19</td>
      <td>20.19</td>
      <td>-0.005419</td>
      <td>0.009725</td>
      <td>-0.026786</td>
    </tr>
    <tr>
      <th>1620</th>
      <td>2016-11-17</td>
      <td>sz300001</td>
      <td>20.09</td>
      <td>20.36</td>
      <td>20.05</td>
      <td>20.13</td>
      <td>-0.002972</td>
      <td>0.003176</td>
      <td>-0.020794</td>
    </tr>
    <tr>
      <th>1621</th>
      <td>2016-11-18</td>
      <td>sz300001</td>
      <td>20.30</td>
      <td>20.30</td>
      <td>20.07</td>
      <td>20.09</td>
      <td>-0.001987</td>
      <td>-0.005181</td>
      <td>-0.017671</td>
    </tr>
    <tr>
      <th>1622</th>
      <td>2016-11-21</td>
      <td>sz300001</td>
      <td>20.10</td>
      <td>20.18</td>
      <td>20.01</td>
      <td>20.10</td>
      <td>0.000498</td>
      <td>-0.010873</td>
      <td>-0.016312</td>
    </tr>
    <tr>
      <th>1623</th>
      <td>2016-11-22</td>
      <td>sz300001</td>
      <td>20.11</td>
      <td>20.27</td>
      <td>20.03</td>
      <td>20.26</td>
      <td>0.007960</td>
      <td>-0.002444</td>
      <td>-0.013538</td>
    </tr>
    <tr>
      <th>1624</th>
      <td>2016-11-23</td>
      <td>sz300001</td>
      <td>20.28</td>
      <td>20.54</td>
      <td>20.28</td>
      <td>20.32</td>
      <td>0.002962</td>
      <td>0.008973</td>
      <td>-0.009036</td>
    </tr>
    <tr>
      <th>1625</th>
      <td>2016-11-24</td>
      <td>sz300001</td>
      <td>20.31</td>
      <td>20.31</td>
      <td>20.07</td>
      <td>20.11</td>
      <td>-0.010335</td>
      <td>0.001064</td>
      <td>-0.007016</td>
    </tr>
    <tr>
      <th>1626</th>
      <td>2016-11-25</td>
      <td>sz300001</td>
      <td>20.08</td>
      <td>20.39</td>
      <td>20.02</td>
      <td>20.37</td>
      <td>0.012929</td>
      <td>0.015596</td>
      <td>-0.002493</td>
    </tr>
    <tr>
      <th>1627</th>
      <td>2016-11-28</td>
      <td>sz300001</td>
      <td>20.45</td>
      <td>20.50</td>
      <td>20.21</td>
      <td>20.24</td>
      <td>-0.006382</td>
      <td>0.016434</td>
      <td>0.001292</td>
    </tr>
    <tr>
      <th>1628</th>
      <td>2016-11-29</td>
      <td>sz300001</td>
      <td>20.24</td>
      <td>20.45</td>
      <td>20.15</td>
      <td>20.21</td>
      <td>-0.001482</td>
      <td>0.014509</td>
      <td>0.003935</td>
    </tr>
    <tr>
      <th>1629</th>
      <td>2016-11-30</td>
      <td>sz300001</td>
      <td>20.16</td>
      <td>20.47</td>
      <td>20.11</td>
      <td>20.34</td>
      <td>0.006432</td>
      <td>0.023207</td>
      <td>0.007790</td>
    </tr>
    <tr>
      <th>1630</th>
      <td>2016-12-01</td>
      <td>sz300001</td>
      <td>20.38</td>
      <td>20.76</td>
      <td>20.31</td>
      <td>20.66</td>
      <td>0.015733</td>
      <td>0.055284</td>
      <td>0.017289</td>
    </tr>
    <tr>
      <th>1631</th>
      <td>2016-12-02</td>
      <td>sz300001</td>
      <td>20.55</td>
      <td>20.62</td>
      <td>20.21</td>
      <td>20.22</td>
      <td>-0.021297</td>
      <td>0.044685</td>
      <td>0.022768</td>
    </tr>
    <tr>
      <th>1632</th>
      <td>2016-12-05</td>
      <td>sz300001</td>
      <td>20.05</td>
      <td>20.48</td>
      <td>20.01</td>
      <td>20.21</td>
      <td>-0.000495</td>
      <td>0.035075</td>
      <td>0.025229</td>
    </tr>
    <tr>
      <th>1633</th>
      <td>2016-12-06</td>
      <td>sz300001</td>
      <td>20.25</td>
      <td>20.39</td>
      <td>20.02</td>
      <td>20.02</td>
      <td>-0.009401</td>
      <td>0.011989</td>
      <td>0.022581</td>
    </tr>
    <tr>
      <th>1634</th>
      <td>2016-12-07</td>
      <td>sz300001</td>
      <td>20.02</td>
      <td>20.12</td>
      <td>19.81</td>
      <td>20.06</td>
      <td>0.001998</td>
      <td>-0.003044</td>
      <td>0.017456</td>
    </tr>
    <tr>
      <th>1635</th>
      <td>2016-12-08</td>
      <td>sz300001</td>
      <td>20.06</td>
      <td>20.10</td>
      <td>19.70</td>
      <td>19.71</td>
      <td>-0.017448</td>
      <td>-0.042708</td>
      <td>0.005423</td>
    </tr>
    <tr>
      <th>1636</th>
      <td>2016-12-09</td>
      <td>sz300001</td>
      <td>19.77</td>
      <td>19.85</td>
      <td>19.35</td>
      <td>19.49</td>
      <td>-0.011162</td>
      <td>-0.090847</td>
      <td>-0.013831</td>
    </tr>
    <tr>
      <th>1637</th>
      <td>2016-12-12</td>
      <td>sz300001</td>
      <td>19.57</td>
      <td>19.66</td>
      <td>17.74</td>
      <td>17.90</td>
      <td>-0.081580</td>
      <td>-0.254364</td>
      <td>-0.061937</td>
    </tr>
    <tr>
      <th>1638</th>
      <td>2016-12-13</td>
      <td>sz300001</td>
      <td>17.99</td>
      <td>18.18</td>
      <td>17.78</td>
      <td>17.91</td>
      <td>0.000559</td>
      <td>-0.378780</td>
      <td>-0.125306</td>
    </tr>
    <tr>
      <th>1639</th>
      <td>2016-12-14</td>
      <td>sz300001</td>
      <td>17.92</td>
      <td>18.15</td>
      <td>17.78</td>
      <td>17.95</td>
      <td>0.002233</td>
      <td>-0.468749</td>
      <td>-0.193995</td>
    </tr>
  </tbody>
</table>
<p>1640 rows × 9 columns</p>
</div>




```python
def kdj(df, n=9):
    df['max'] = df['最高价'].rolling(window=n).max()
    df['min'] = df['最低价'].rolling(window=n).min()
    df['rsv'] = (df['收盘价'] - df['min']) / (df['max'] - df['min']) * 100
    
    df.dropna(inplace=True)

    df['K'] = df['rsv'].ewm(com=2, adjust=False).mean()
    df['D'] = df['K'].ewm(com=2, adjust=False).mean()
    df['J'] = 3 * df['K'] - 2 * df['D']
    
    df.drop(['max', 'min', 'rsv'],  axis=1, inplace=True)
    
    return df
```


```python
kdj(df)
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>交易日期</th>
      <th>股票代码</th>
      <th>开盘价</th>
      <th>最高价</th>
      <th>最低价</th>
      <th>收盘价</th>
      <th>涨跌幅</th>
      <th>DIF</th>
      <th>DEA</th>
      <th>K</th>
      <th>D</th>
      <th>J</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>2009-11-11</td>
      <td>sz300001</td>
      <td>37.65</td>
      <td>38.40</td>
      <td>37.00</td>
      <td>38.22</td>
      <td>0.006584</td>
      <td>-1.512963</td>
      <td>-1.069714</td>
      <td>11.072784</td>
      <td>11.072784</td>
      <td>11.072784</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2009-11-12</td>
      <td>sz300001</td>
      <td>38.20</td>
      <td>38.89</td>
      <td>37.50</td>
      <td>38.56</td>
      <td>0.008896</td>
      <td>-1.515470</td>
      <td>-1.158865</td>
      <td>21.426145</td>
      <td>14.523904</td>
      <td>35.230626</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2009-11-13</td>
      <td>sz300001</td>
      <td>38.57</td>
      <td>41.87</td>
      <td>38.57</td>
      <td>40.76</td>
      <td>0.057054</td>
      <td>-1.324665</td>
      <td>-1.192025</td>
      <td>41.148898</td>
      <td>23.398902</td>
      <td>76.648891</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2009-11-16</td>
      <td>sz300001</td>
      <td>40.80</td>
      <td>41.30</td>
      <td>39.62</td>
      <td>41.00</td>
      <td>0.005888</td>
      <td>-1.140933</td>
      <td>-1.181807</td>
      <td>54.811107</td>
      <td>33.869637</td>
      <td>96.694046</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2009-11-17</td>
      <td>sz300001</td>
      <td>40.90</td>
      <td>41.82</td>
      <td>40.55</td>
      <td>40.90</td>
      <td>-0.002439</td>
      <td>-0.991958</td>
      <td>-1.143837</td>
      <td>63.234783</td>
      <td>43.658019</td>
      <td>102.388311</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2009-11-18</td>
      <td>sz300001</td>
      <td>41.00</td>
      <td>43.16</td>
      <td>41.00</td>
      <td>42.84</td>
      <td>0.047433</td>
      <td>-0.709178</td>
      <td>-1.056905</td>
      <td>73.758254</td>
      <td>53.691431</td>
      <td>113.891900</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2009-11-19</td>
      <td>sz300001</td>
      <td>42.90</td>
      <td>47.10</td>
      <td>42.72</td>
      <td>44.91</td>
      <td>0.048319</td>
      <td>-0.314416</td>
      <td>-0.908407</td>
      <td>75.277780</td>
      <td>60.886880</td>
      <td>104.059578</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2009-11-20</td>
      <td>sz300001</td>
      <td>44.33</td>
      <td>46.55</td>
      <td>44.10</td>
      <td>44.38</td>
      <td>-0.011801</td>
      <td>-0.043827</td>
      <td>-0.735491</td>
      <td>74.541622</td>
      <td>65.438461</td>
      <td>92.747944</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2009-11-23</td>
      <td>sz300001</td>
      <td>44.33</td>
      <td>45.98</td>
      <td>44.12</td>
      <td>45.41</td>
      <td>0.023209</td>
      <td>0.250839</td>
      <td>-0.538225</td>
      <td>77.450190</td>
      <td>69.442371</td>
      <td>93.465830</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2009-11-24</td>
      <td>sz300001</td>
      <td>45.80</td>
      <td>46.23</td>
      <td>41.01</td>
      <td>41.43</td>
      <td>-0.087646</td>
      <td>0.161350</td>
      <td>-0.398310</td>
      <td>65.279294</td>
      <td>68.054678</td>
      <td>59.728524</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2009-11-25</td>
      <td>sz300001</td>
      <td>41.13</td>
      <td>44.19</td>
      <td>41.10</td>
      <td>43.90</td>
      <td>0.059619</td>
      <td>0.286437</td>
      <td>-0.261361</td>
      <td>64.347978</td>
      <td>66.819111</td>
      <td>59.405710</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2009-11-26</td>
      <td>sz300001</td>
      <td>43.70</td>
      <td>47.49</td>
      <td>43.00</td>
      <td>47.28</td>
      <td>0.076993</td>
      <td>0.650804</td>
      <td>-0.078928</td>
      <td>75.342531</td>
      <td>69.660251</td>
      <td>86.707092</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2009-11-27</td>
      <td>sz300001</td>
      <td>46.10</td>
      <td>48.60</td>
      <td>45.54</td>
      <td>47.30</td>
      <td>0.000423</td>
      <td>0.930456</td>
      <td>0.122949</td>
      <td>78.178665</td>
      <td>72.499723</td>
      <td>89.536549</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2009-11-30</td>
      <td>sz300001</td>
      <td>47.32</td>
      <td>47.90</td>
      <td>45.00</td>
      <td>46.92</td>
      <td>-0.008034</td>
      <td>1.108640</td>
      <td>0.320087</td>
      <td>78.084022</td>
      <td>74.361156</td>
      <td>85.529755</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2009-12-01</td>
      <td>sz300001</td>
      <td>46.48</td>
      <td>47.38</td>
      <td>45.70</td>
      <td>46.98</td>
      <td>0.001279</td>
      <td>1.240395</td>
      <td>0.504149</td>
      <td>78.274724</td>
      <td>75.665678</td>
      <td>83.492814</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2009-12-02</td>
      <td>sz300001</td>
      <td>47.10</td>
      <td>49.85</td>
      <td>46.68</td>
      <td>48.17</td>
      <td>0.025330</td>
      <td>1.424415</td>
      <td>0.688202</td>
      <td>79.181641</td>
      <td>76.837666</td>
      <td>83.869591</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2009-12-03</td>
      <td>sz300001</td>
      <td>48.01</td>
      <td>50.24</td>
      <td>47.19</td>
      <td>50.16</td>
      <td>0.041312</td>
      <td>1.711104</td>
      <td>0.892782</td>
      <td>85.832181</td>
      <td>79.835838</td>
      <td>97.824868</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2009-12-04</td>
      <td>sz300001</td>
      <td>48.00</td>
      <td>49.15</td>
      <td>45.14</td>
      <td>45.56</td>
      <td>-0.091707</td>
      <td>1.549266</td>
      <td>1.024079</td>
      <td>73.653379</td>
      <td>77.775018</td>
      <td>65.410101</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2009-12-07</td>
      <td>sz300001</td>
      <td>45.30</td>
      <td>46.52</td>
      <td>44.60</td>
      <td>46.32</td>
      <td>0.016681</td>
      <td>1.465442</td>
      <td>1.112352</td>
      <td>68.139452</td>
      <td>74.563163</td>
      <td>55.292030</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2009-12-08</td>
      <td>sz300001</td>
      <td>46.30</td>
      <td>48.43</td>
      <td>46.30</td>
      <td>47.86</td>
      <td>0.033247</td>
      <td>1.505916</td>
      <td>1.191065</td>
      <td>67.801992</td>
      <td>72.309439</td>
      <td>58.787097</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2009-12-09</td>
      <td>sz300001</td>
      <td>47.40</td>
      <td>49.80</td>
      <td>47.04</td>
      <td>48.01</td>
      <td>0.003134</td>
      <td>1.532432</td>
      <td>1.259338</td>
      <td>65.354992</td>
      <td>69.991290</td>
      <td>56.082396</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2009-12-10</td>
      <td>sz300001</td>
      <td>48.00</td>
      <td>48.99</td>
      <td>47.00</td>
      <td>47.40</td>
      <td>-0.012706</td>
      <td>1.487081</td>
      <td>1.304887</td>
      <td>60.118458</td>
      <td>66.700346</td>
      <td>46.954682</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2009-12-11</td>
      <td>sz300001</td>
      <td>47.40</td>
      <td>47.80</td>
      <td>45.00</td>
      <td>45.42</td>
      <td>-0.041772</td>
      <td>1.276654</td>
      <td>1.299240</td>
      <td>44.925308</td>
      <td>59.442000</td>
      <td>15.891923</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2009-12-14</td>
      <td>sz300001</td>
      <td>45.35</td>
      <td>45.90</td>
      <td>43.40</td>
      <td>44.36</td>
      <td>-0.023338</td>
      <td>1.012683</td>
      <td>1.241929</td>
      <td>34.628568</td>
      <td>51.170856</td>
      <td>1.543991</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2009-12-15</td>
      <td>sz300001</td>
      <td>44.50</td>
      <td>45.96</td>
      <td>44.50</td>
      <td>45.10</td>
      <td>0.016682</td>
      <td>0.853359</td>
      <td>1.164215</td>
      <td>31.370312</td>
      <td>44.570675</td>
      <td>4.969587</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2009-12-16</td>
      <td>sz300001</td>
      <td>45.00</td>
      <td>45.49</td>
      <td>42.80</td>
      <td>43.14</td>
      <td>-0.043459</td>
      <td>0.562454</td>
      <td>1.043862</td>
      <td>22.532589</td>
      <td>37.224646</td>
      <td>-6.851525</td>
    </tr>
    <tr>
      <th>34</th>
      <td>2009-12-17</td>
      <td>sz300001</td>
      <td>43.16</td>
      <td>43.44</td>
      <td>40.20</td>
      <td>40.37</td>
      <td>-0.064210</td>
      <td>0.107158</td>
      <td>0.856522</td>
      <td>15.612004</td>
      <td>30.020432</td>
      <td>-13.204853</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2009-12-18</td>
      <td>sz300001</td>
      <td>40.00</td>
      <td>44.00</td>
      <td>38.58</td>
      <td>42.18</td>
      <td>0.044835</td>
      <td>-0.106388</td>
      <td>0.663940</td>
      <td>21.103190</td>
      <td>27.048018</td>
      <td>9.213533</td>
    </tr>
    <tr>
      <th>36</th>
      <td>2009-12-21</td>
      <td>sz300001</td>
      <td>42.49</td>
      <td>44.68</td>
      <td>41.80</td>
      <td>44.00</td>
      <td>0.043148</td>
      <td>-0.127299</td>
      <td>0.505692</td>
      <td>30.170992</td>
      <td>28.089009</td>
      <td>34.334957</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2009-12-22</td>
      <td>sz300001</td>
      <td>43.79</td>
      <td>44.19</td>
      <td>41.30</td>
      <td>41.75</td>
      <td>-0.051136</td>
      <td>-0.321719</td>
      <td>0.340210</td>
      <td>30.264491</td>
      <td>28.814170</td>
      <td>33.165133</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1610</th>
      <td>2016-11-03</td>
      <td>sz300001</td>
      <td>20.21</td>
      <td>20.39</td>
      <td>20.09</td>
      <td>20.16</td>
      <td>-0.006407</td>
      <td>-0.070107</td>
      <td>-0.125584</td>
      <td>69.011153</td>
      <td>55.856628</td>
      <td>95.320204</td>
    </tr>
    <tr>
      <th>1611</th>
      <td>2016-11-04</td>
      <td>sz300001</td>
      <td>20.13</td>
      <td>20.30</td>
      <td>19.94</td>
      <td>20.14</td>
      <td>-0.000992</td>
      <td>-0.061237</td>
      <td>-0.112714</td>
      <td>67.263474</td>
      <td>59.658910</td>
      <td>82.472602</td>
    </tr>
    <tr>
      <th>1612</th>
      <td>2016-11-07</td>
      <td>sz300001</td>
      <td>20.11</td>
      <td>20.24</td>
      <td>19.96</td>
      <td>20.16</td>
      <td>0.000993</td>
      <td>-0.051994</td>
      <td>-0.100570</td>
      <td>67.064538</td>
      <td>62.127453</td>
      <td>76.938709</td>
    </tr>
    <tr>
      <th>1613</th>
      <td>2016-11-08</td>
      <td>sz300001</td>
      <td>20.16</td>
      <td>20.24</td>
      <td>20.01</td>
      <td>20.14</td>
      <td>-0.000992</td>
      <td>-0.045755</td>
      <td>-0.089607</td>
      <td>65.965731</td>
      <td>63.406879</td>
      <td>71.083435</td>
    </tr>
    <tr>
      <th>1614</th>
      <td>2016-11-09</td>
      <td>sz300001</td>
      <td>20.07</td>
      <td>20.19</td>
      <td>19.72</td>
      <td>19.97</td>
      <td>-0.008441</td>
      <td>-0.053907</td>
      <td>-0.082467</td>
      <td>56.414965</td>
      <td>61.076241</td>
      <td>47.092413</td>
    </tr>
    <tr>
      <th>1615</th>
      <td>2016-11-10</td>
      <td>sz300001</td>
      <td>20.09</td>
      <td>20.35</td>
      <td>20.08</td>
      <td>20.31</td>
      <td>0.017026</td>
      <td>-0.032558</td>
      <td>-0.072485</td>
      <td>66.963210</td>
      <td>63.038564</td>
      <td>74.812503</td>
    </tr>
    <tr>
      <th>1616</th>
      <td>2016-11-11</td>
      <td>sz300001</td>
      <td>20.31</td>
      <td>20.35</td>
      <td>20.13</td>
      <td>20.34</td>
      <td>0.001477</td>
      <td>-0.013066</td>
      <td>-0.060602</td>
      <td>75.487911</td>
      <td>67.188346</td>
      <td>92.087041</td>
    </tr>
    <tr>
      <th>1617</th>
      <td>2016-11-14</td>
      <td>sz300001</td>
      <td>20.34</td>
      <td>20.55</td>
      <td>20.26</td>
      <td>20.35</td>
      <td>0.000492</td>
      <td>0.003151</td>
      <td>-0.047851</td>
      <td>75.626479</td>
      <td>70.001057</td>
      <td>86.877323</td>
    </tr>
    <tr>
      <th>1618</th>
      <td>2016-11-15</td>
      <td>sz300001</td>
      <td>20.27</td>
      <td>20.34</td>
      <td>20.04</td>
      <td>20.30</td>
      <td>-0.002457</td>
      <td>0.011833</td>
      <td>-0.035914</td>
      <td>73.710825</td>
      <td>71.237647</td>
      <td>78.657183</td>
    </tr>
    <tr>
      <th>1619</th>
      <td>2016-11-16</td>
      <td>sz300001</td>
      <td>20.40</td>
      <td>20.54</td>
      <td>20.19</td>
      <td>20.19</td>
      <td>-0.005419</td>
      <td>0.009725</td>
      <td>-0.026786</td>
      <td>68.016052</td>
      <td>70.163782</td>
      <td>63.720593</td>
    </tr>
    <tr>
      <th>1620</th>
      <td>2016-11-17</td>
      <td>sz300001</td>
      <td>20.09</td>
      <td>20.36</td>
      <td>20.05</td>
      <td>20.13</td>
      <td>-0.002972</td>
      <td>0.003176</td>
      <td>-0.020794</td>
      <td>61.809898</td>
      <td>67.379154</td>
      <td>50.671387</td>
    </tr>
    <tr>
      <th>1621</th>
      <td>2016-11-18</td>
      <td>sz300001</td>
      <td>20.30</td>
      <td>20.30</td>
      <td>20.07</td>
      <td>20.09</td>
      <td>-0.001987</td>
      <td>-0.005181</td>
      <td>-0.017671</td>
      <td>56.066037</td>
      <td>63.608115</td>
      <td>40.981880</td>
    </tr>
    <tr>
      <th>1622</th>
      <td>2016-11-21</td>
      <td>sz300001</td>
      <td>20.10</td>
      <td>20.18</td>
      <td>20.01</td>
      <td>20.10</td>
      <td>0.000498</td>
      <td>-0.010873</td>
      <td>-0.016312</td>
      <td>52.638402</td>
      <td>59.951544</td>
      <td>38.012118</td>
    </tr>
    <tr>
      <th>1623</th>
      <td>2016-11-22</td>
      <td>sz300001</td>
      <td>20.11</td>
      <td>20.27</td>
      <td>20.03</td>
      <td>20.26</td>
      <td>0.007960</td>
      <td>-0.002444</td>
      <td>-0.013538</td>
      <td>50.524367</td>
      <td>56.809152</td>
      <td>37.954797</td>
    </tr>
    <tr>
      <th>1624</th>
      <td>2016-11-23</td>
      <td>sz300001</td>
      <td>20.28</td>
      <td>20.54</td>
      <td>20.28</td>
      <td>20.32</td>
      <td>0.002962</td>
      <td>0.008973</td>
      <td>-0.009036</td>
      <td>52.818714</td>
      <td>55.479006</td>
      <td>47.498130</td>
    </tr>
    <tr>
      <th>1625</th>
      <td>2016-11-24</td>
      <td>sz300001</td>
      <td>20.31</td>
      <td>20.31</td>
      <td>20.07</td>
      <td>20.11</td>
      <td>-0.010335</td>
      <td>0.001064</td>
      <td>-0.007016</td>
      <td>41.385315</td>
      <td>50.781109</td>
      <td>22.593728</td>
    </tr>
    <tr>
      <th>1626</th>
      <td>2016-11-25</td>
      <td>sz300001</td>
      <td>20.08</td>
      <td>20.39</td>
      <td>20.02</td>
      <td>20.37</td>
      <td>0.012929</td>
      <td>0.015596</td>
      <td>-0.002493</td>
      <td>50.231720</td>
      <td>50.597979</td>
      <td>49.499201</td>
    </tr>
    <tr>
      <th>1627</th>
      <td>2016-11-28</td>
      <td>sz300001</td>
      <td>20.45</td>
      <td>20.50</td>
      <td>20.21</td>
      <td>20.24</td>
      <td>-0.006382</td>
      <td>0.016434</td>
      <td>0.001292</td>
      <td>47.953222</td>
      <td>49.716393</td>
      <td>44.426879</td>
    </tr>
    <tr>
      <th>1628</th>
      <td>2016-11-29</td>
      <td>sz300001</td>
      <td>20.24</td>
      <td>20.45</td>
      <td>20.15</td>
      <td>20.21</td>
      <td>-0.001482</td>
      <td>0.014509</td>
      <td>0.003935</td>
      <td>44.547431</td>
      <td>47.993406</td>
      <td>37.655481</td>
    </tr>
    <tr>
      <th>1629</th>
      <td>2016-11-30</td>
      <td>sz300001</td>
      <td>20.16</td>
      <td>20.47</td>
      <td>20.11</td>
      <td>20.34</td>
      <td>0.006432</td>
      <td>0.023207</td>
      <td>0.007790</td>
      <td>50.453004</td>
      <td>48.813272</td>
      <td>53.732469</td>
    </tr>
    <tr>
      <th>1630</th>
      <td>2016-12-01</td>
      <td>sz300001</td>
      <td>20.38</td>
      <td>20.76</td>
      <td>20.31</td>
      <td>20.66</td>
      <td>0.015733</td>
      <td>0.055284</td>
      <td>0.017289</td>
      <td>62.524225</td>
      <td>53.383590</td>
      <td>80.805496</td>
    </tr>
    <tr>
      <th>1631</th>
      <td>2016-12-02</td>
      <td>sz300001</td>
      <td>20.55</td>
      <td>20.62</td>
      <td>20.21</td>
      <td>20.22</td>
      <td>-0.021297</td>
      <td>0.044685</td>
      <td>0.022768</td>
      <td>50.691826</td>
      <td>52.486335</td>
      <td>47.102807</td>
    </tr>
    <tr>
      <th>1632</th>
      <td>2016-12-05</td>
      <td>sz300001</td>
      <td>20.05</td>
      <td>20.48</td>
      <td>20.01</td>
      <td>20.21</td>
      <td>-0.000495</td>
      <td>0.035075</td>
      <td>0.025229</td>
      <td>42.683439</td>
      <td>49.218703</td>
      <td>29.612912</td>
    </tr>
    <tr>
      <th>1633</th>
      <td>2016-12-06</td>
      <td>sz300001</td>
      <td>20.25</td>
      <td>20.39</td>
      <td>20.02</td>
      <td>20.02</td>
      <td>-0.009401</td>
      <td>0.011989</td>
      <td>0.022581</td>
      <td>28.900071</td>
      <td>42.445826</td>
      <td>1.808561</td>
    </tr>
    <tr>
      <th>1634</th>
      <td>2016-12-07</td>
      <td>sz300001</td>
      <td>20.02</td>
      <td>20.12</td>
      <td>19.81</td>
      <td>20.06</td>
      <td>0.001998</td>
      <td>-0.003044</td>
      <td>0.017456</td>
      <td>28.038644</td>
      <td>37.643432</td>
      <td>8.829068</td>
    </tr>
    <tr>
      <th>1635</th>
      <td>2016-12-08</td>
      <td>sz300001</td>
      <td>20.06</td>
      <td>20.10</td>
      <td>19.70</td>
      <td>19.71</td>
      <td>-0.017448</td>
      <td>-0.042708</td>
      <td>0.005423</td>
      <td>19.006894</td>
      <td>31.431253</td>
      <td>-5.841822</td>
    </tr>
    <tr>
      <th>1636</th>
      <td>2016-12-09</td>
      <td>sz300001</td>
      <td>19.77</td>
      <td>19.85</td>
      <td>19.35</td>
      <td>19.49</td>
      <td>-0.011162</td>
      <td>-0.090847</td>
      <td>-0.013831</td>
      <td>15.980956</td>
      <td>26.281154</td>
      <td>-4.619440</td>
    </tr>
    <tr>
      <th>1637</th>
      <td>2016-12-12</td>
      <td>sz300001</td>
      <td>19.57</td>
      <td>19.66</td>
      <td>17.74</td>
      <td>17.90</td>
      <td>-0.081580</td>
      <td>-0.254364</td>
      <td>-0.061937</td>
      <td>12.419975</td>
      <td>21.660761</td>
      <td>-6.061597</td>
    </tr>
    <tr>
      <th>1638</th>
      <td>2016-12-13</td>
      <td>sz300001</td>
      <td>17.99</td>
      <td>18.18</td>
      <td>17.78</td>
      <td>17.91</td>
      <td>0.000559</td>
      <td>-0.378780</td>
      <td>-0.125306</td>
      <td>10.156363</td>
      <td>17.825961</td>
      <td>-5.182834</td>
    </tr>
    <tr>
      <th>1639</th>
      <td>2016-12-14</td>
      <td>sz300001</td>
      <td>17.92</td>
      <td>18.15</td>
      <td>17.78</td>
      <td>17.95</td>
      <td>0.002233</td>
      <td>-0.468749</td>
      <td>-0.193995</td>
      <td>9.201464</td>
      <td>14.951129</td>
      <td>-2.297866</td>
    </tr>
  </tbody>
</table>
<p>1632 rows × 12 columns</p>
</div>


